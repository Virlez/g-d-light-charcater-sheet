<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWTOR - Datapad Personnel</title>
    <!-- Site icon / favicon and app assets (cache-busted) -->
    <script>
        // Cache-busting loader: append a short-lived version query so
        // browsers fetch the latest files without needing Ctrl+F5.
        // Uses a timestamp to ensure freshness on each load.
        (function () {
            const v = Date.now();
            // favicon
            const icon = document.createElement('link');
            icon.rel = 'icon';
            icon.type = 'image/svg+xml';
            icon.href = 'favicon.svg?v=' + v;
            document.head.appendChild(icon);
            const apple = document.createElement('link');
            apple.rel = 'apple-touch-icon';
            apple.href = 'favicon.svg?v=' + v;
            document.head.appendChild(apple);

            // stylesheet
            const css = document.createElement('link');
            css.rel = 'stylesheet';
            css.href = 'styles.css?v=' + v;
            document.head.appendChild(css);
        })();
    </script>
    <meta name="theme-color" content="#00141a">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="min-h-screen p-4 md:p-8 flex justify-center overflow-x-hidden relative">

    <div class="scanline fixed top-0 left-0 w-full h-screen pointer-events-none"></div>

    <div class="w-full max-w-5xl relative z-10">
        
        <header class="flex flex-col md:flex-row justify-between items-end mb-6 border-b-2 border-[#004e53] pb-4">
            <div class="mb-2 md:mb-0">
                <h1 class="text-3xl md:text-4xl text-[#00f0ff] drop-shadow-[0_0_10px_rgba(0,240,255,0.6)]">Fiche de Personnage</h1>
                <p class="text-xs tracking-widest text-gray-400 mt-1">SYSTÈME ARCHIVES // SWTOR</p>
            </div>
            <div class="flex gap-4 w-full md:w-auto">
                <div class="flex-1 md:w-40">
                    <label class="block text-[12px] text-[#00f0ff] uppercase mb-1">Joueur</label>
                    <input type="text" id="player_name" class="w-full px-2 py-1 clip-corner text-sm" placeholder="Nom">
                </div>
                <div class="flex-1 md:w-40">
                    <label class="block text-[12px] text-[#00f0ff] uppercase mb-1">Guilde</label>
                    <input type="text" id="guild_name" class="w-full px-2 py-1 clip-corner text-sm" placeholder="Guilde">
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">

            <div class="lg:col-span-2 space-y-4">
                
                <section class="section-box p-3 clip-corner-inv">
                    <h2 class="text-lg text-[#00f0ff] mb-2 border-b border-[#004e53] inline-block pr-4">Renseignements Généraux</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div class="md:col-span-2">
                            <label class="text-[12px] text-gray-400 block mb-1">Noms</label>
                            <input type="text" id="char_name" class="w-full p-1 px-2 text-base font-bold">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block mb-1">Alias / Titre</label>
                            <input type="text" id="char_alias" class="w-full p-1 px-2 text-sm">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block mb-1">Race</label>
                            <input type="text" id="char_race" class="w-full p-1 px-2 text-sm">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block mb-1">Sexe</label>
                            <input type="text" id="char_sex" class="w-full p-1 px-2 text-sm">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block mb-1">Taille / Âge</label>
                            <input type="text" id="char_age" class="w-full p-1 px-2 text-sm">
                        </div>
                    </div>
                </section>

                <section class="section-box p-3 clip-corner">
                    <h2 class="text-lg text-[#00f0ff] mb-2 border-b border-[#004e53] inline-block pr-4">Défenses & Statistiques</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full sw-table text-center border-collapse text-sm">
                            <thead>
                                <tr>
                                    <th>Niv.</th>
                                    <th>PA</th>
                                    <th>Bouclier</th>
                                    <th>BP</th>
                                    <th>PV</th>
                                    <th>Init.</th>
                                    <th>Réaction</th>
                                    <th>Résistance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><input type="number" id="stat_lvl" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="1"></td>
                                    <td><input type="number" id="stat_pa" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="0"></td>
                                    <td><input type="number" id="stat_shield" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]"></td>
                                    <td><input type="number" id="stat_bp" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]"></td>
                                    <td><input type="number" id="stat_hp" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="5"></td>
                                    <td><input type="number" id="stat_init" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="1"></td>
                                    <td><input type="number" id="stat_def" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="1"></td>
                                    <td><input type="number" id="stat_res" class="w-full text-center bg-transparent border-0 border-b border-[#004e53]" value="1"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="section-box p-3 clip-corner-inv">
                    <h2 class="text-lg text-[#00f0ff] mb-2 border-b border-[#004e53] inline-block pr-4">Attributs</h2>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                        
                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">CONSTITUTION</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_con" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_con_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">FORCE</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_str" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_str_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">PHYSIQUE</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_phy" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_phy_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">DISTANCE</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_dist" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_dist_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">SAVOIR</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_know" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_know_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">SOCIAL</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_soc" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_soc_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">PILOTAGE</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_pilot" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_pilot_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                        <div class="attr-box bg-[#00141a] p-1 border border-[#004e53] flex flex-col justify-between">
                            <label class="block text-[12px] text-gray-400 mb-1 text-center font-bold">EXPLORATION</label>
                            <div class="flex items-end gap-1">
                                <input type="number" id="attr_expl" value="1" class="w-2/3 text-center text-xl font-bold bg-transparent border-none focus:ring-0 p-0 h-8">
                                <div class="w-1/3 flex flex-col items-center">
                                    <span class="text-[8px] text-[#004e53] mb-0 leading-none">BONUS</span>
                                    <input type="number" id="attr_expl_bonus" value="0" class="attr-bonus-input w-full text-center text-sm text-[#00f0ff] bg-[rgba(0,0,0,0.2)] border border-[#004e53] p-0 h-6">
                                </div>
                            </div>
                        </div>

                    </div>
                </section>
            </div>

            <div class="space-y-4">
                
                <div class="section-box p-1 h-48 char-img-placeholder clip-corner relative group">
                    <!-- Hidden file input; label will trigger it for better cross-browser reliability -->
                    <input type="file" id="imgUpload" accept="image/*" class="hidden">
                    <div id="imgPreview" class="w-full h-full bg-cover bg-center absolute inset-0 z-10 hidden" aria-hidden="true"></div>

                    <!-- Clickable label covers the whole area and opens file dialog -->
                    <label for="imgUpload" class="absolute inset-0 z-20 flex items-center justify-center cursor-pointer">
                        <div class="placeholder-content pointer-events-none">
                            <!-- Datapad-style placeholder icon -->
                            <svg viewBox="0 0 64 64" aria-hidden="true" focusable="false" class="placeholder-icon pulse">
                                <rect x="6" y="8" width="52" height="40" rx="4" class="frame accent" fill="currentColor" opacity="0.04" stroke="none"></rect>
                                <rect x="14" y="16" width="36" height="6" rx="1" class="accent" opacity="0.06"></rect>
                                <rect x="14" y="26" width="24" height="4" rx="1" class="accent" opacity="0.04"></rect>
                                <rect x="14" y="32" width="28" height="4" rx="1" class="accent" opacity="0.04"></rect>
                                <circle cx="48" cy="22" r="2" class="accent"></circle>
                                <rect x="10" y="52" width="44" height="2" rx="1" class="accent" opacity="0.08"></rect>
                            </svg>
                            <span class="placeholder-text">Photo</span>
                        </div>
                    </label>
                </div>

                <section class="section-box p-3 clip-corner">
                    <h3 class="text-md text-[#00f0ff] mb-2 border-b border-[#004e53]">Précisions</h3>
                    
                    <div class="space-y-2">
                        <div>
                            <label class="text-[12px] text-gray-400">Race (Détails)</label>
                            <input type="text" id="race_details" class="w-full p-1 text-xs">
                        </div>
                        
                        <div class="flex items-center justify-between border border-[#004e53] p-1 px-2 bg-[#00141a]">
                            <span class="text-xs">Utilisateur Force</span>
                            <div class="flex gap-2 text-xs">
                                <label class="flex items-center cursor-pointer">
                                    <input type="radio" name="force" id="force_yes" value="yes" class="mr-1 accent-[#00f0ff]"> Oui
                                </label>
                                <label class="flex items-center cursor-pointer">
                                    <input type="radio" name="force" id="force_no" value="no" class="mr-1 accent-[#00f0ff]" checked> Non
                                </label>
                            </div>
                        </div>

                        <div class="flex items-center justify-between border border-[#004e53] p-1 px-2 bg-[#00141a]">
                            <span class="text-xs">Âge Catégorie</span>
                            <select id="age_cat" class="bg-transparent text-xs text-[#00f0ff] border-none outline-none text-right">
                                <option value="Jeune">Jeune</option>
                                <option value="Ancien">Ancien</option>
                                <option value="Standard" selected>Standard</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-[12px] text-gray-400">Cybernétique</label>
                            <input type="text" id="cybernetics" class="w-full p-1 text-xs">
                        </div>

                        <div>
                            <label class="text-[12px] text-gray-400">Langues Vivantes</label>
                            <textarea id="lang_live" class="w-full p-1 text-xs h-12 bg-transparent resize-none"></textarea>
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400">Langues Mortes</label>
                            <input type="text" id="lang_dead" class="w-full p-1 text-xs">
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <div class="mt-4 space-y-4">
            
            <section class="section-box p-3 clip-corner relative">
                <h2 class="text-lg text-[#00f0ff] mb-2 border-b border-[#004e53] flex justify-between">
                    <span>Talents & Capacités</span>
                </h2>
                <textarea id="talents" class="w-full h-screen bg-transparent border border-[#004e53] p-2 text-sm leading-relaxed text-[#c4f0ff] focus:bg-[#00141a]" placeholder="Listez vos talents ici..."></textarea>
            </section>

            <section class="section-box p-3 clip-corner-inv">
                <h2 class="text-lg text-[#00f0ff] mb-2 border-b border-[#004e53]">Inventaire</h2>
                
                    <div id="inventory_row" class="grid grid-cols-1 md:grid-cols-5 gap-2 mb-2 items-end">
                        <div>
                            <label class="text-[12px] text-gray-400 block">Type d'armure</label>
                            <select id="armor_type" class="w-full p-1 text-sm bg-transparent border border-[#004e53] text-[#00f0ff]">
                                <option value="none" selected>Aucune</option>
                                <option value="40">Légère</option>
                                <option value="60">Intermédiaire</option>
                                <option value="80">Lourde</option>
                            </select>
                        </div>
                        <div id="armor_exotic_container" class="flex items-center gap-2 self-center justify-center">
                            <input type="checkbox" id="armor_exotic" class="accent-[#00f0ff]">
                            <label for="armor_exotic" class="text-[12px] text-gray-400">Est en composant exotique ?</label>
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block">Armure (PA)</label>
                            <input type="number" id="inv_pa" class="w-full p-1 text-yellow-400 font-bold text-sm" inputmode="numeric" step="1" min="0">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block">Bouclier Psy (BP)</label>
                            <input type="number" id="inv_bp" class="w-full p-1 text-purple-400 font-bold text-sm" inputmode="numeric" step="1" min="0">
                        </div>
                        <div>
                            <label class="text-[12px] text-gray-400 block">Bouclier</label>
                            <input type="number" id="inv_shield" class="w-full p-1 text-blue-400 font-bold text-sm" inputmode="numeric" step="1" min="0">
                        </div>
                    </div>

                <div class="mb-2">
                    <div class="flex justify-between items-center mb-1">
                        <label class="text-[12px] text-gray-400 block">Armes</label>
                        <button onclick="addWeapon()" type="button" class="text-xs bg-[#002e33] hover:bg-[#00f0ff] hover:text-black text-[#00f0ff] px-2 py-1 rounded clip-corner transition-colors">+</button>
                    </div>
                    <div class="weapons-headers grid grid-cols-5 gap-2 mb-1 text-[12px] text-gray-400">
                        <div class="text-left">Nom</div>
                        <div class="text-left">Base</div>
                        <div class="text-left">Attribut</div>
                        <div class="text-left">Bonus</div>
                        <div class="text-left">Total</div>
                    </div>
                    <div id="weapons-container" class="space-y-1">
                        <div class="weapon-item grid grid-cols-5 gap-2 items-center">
                            <input type="text" class="weapon-name w-full p-1 text-xs" placeholder="Nom arme">
                            <input type="number" class="weapon-base w-full p-1 text-xs text-right" value="0" min="0">
                            <select class="weapon-attr w-full p-1 text-xs">
                                <option value="none">Aucun</option>
                                <option value="phy">Physique</option>
                                <option value="dist">Distance</option>
                            </select>
                            <input type="number" class="weapon-bonus w-full p-1 text-xs text-right" value="0" step="1" min="0">
                            <div class="flex items-center gap-2">
                                <input type="number" class="weapon-total w-full p-1 text-xs bg-transparent text-right" value="0" readonly>
                                <button onclick="deleteWeapon(this)" type="button" class="text-xs bg-[#002e33] hover:bg-red-900 hover:text-red-500 text-[#00f0ff] px-2 py-1 rounded clip-corner transition-colors">-</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="text-[12px] text-gray-400 block mb-1">Kits & Divers</label>
                    <textarea id="inv_misc" class="w-full h-20 bg-transparent border border-[#004e53] p-2 text-xs" placeholder="Medpacs, Outils, Crédits..."></textarea>
                </div>
            </section>
        </div>

        <div class="mt-6 flex flex-wrap justify-center gap-4 border-t border-[#004e53] pt-4 no-print">
            <button onclick="exportJSON()" class="bg-[#002e33] hover:bg-[#00f0ff] hover:text-black text-[#00f0ff] px-4 py-2 rounded clip-corner transition-colors uppercase font-bold text-xs">
                Sauvegarder (JSON)
            </button>
            
            <button onclick="document.getElementById('importFile').click()" class="bg-[#002e33] hover:bg-[#00f0ff] hover:text-black text-[#00f0ff] px-4 py-2 rounded clip-corner transition-colors uppercase font-bold text-xs">
                Charger (JSON)
            </button>
            <input type="file" id="importFile" accept=".json" class="hidden" onchange="importJSON(this)">

            <button onclick="resetSheet()" class="bg-[#002e33] hover:bg-red-900 hover:text-red-500 text-[#00f0ff] px-4 py-2 rounded clip-corner transition-colors uppercase font-bold text-xs border border-transparent hover:border-red-500">
                Réinitialiser
            </button>

            <button onclick="window.print()" class="bg-[#004e53] hover:bg-[#00f0ff] hover:text-black text-[#00f0ff] px-6 py-2 rounded clip-corner transition-colors uppercase font-bold tracking-widest text-sm">
                Imprimer / PDF
            </button>
        </div>
        <p class="text-center text-xs text-gray-600 mt-2 mb-4">© SWTOR RPG System Fan Sheet</p>

    </div>

    <script>
        // Load app script with cache-busting query so updates appear reliably
        (function () {
            const v = Date.now();
            const s = document.createElement('script');
            s.src = 'script.js?v=' + v;
            s.defer = true;
            document.body.appendChild(s);
        })();
    </script>
</body>
</html>
